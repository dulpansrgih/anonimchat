<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulir Anonim Message</title>
    <link rel="icon" type="image/png" href="/asset/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/asset/favicon.ico">
    <link rel="manifest" href="/site.webmanifest">
    <style>
        /* Variabel CSS untuk Konsep Dark Mode & Hijau Cerah */
        :root {
            --primary-color: #4CAF50;      /* Hijau Cerah */
            --secondary-color: #388E3C;     /* Hijau Gelap */
            --background-color: #1a1a1a;   
            --card-background: #252525;    
            --text-color: #f0f0f0;          
            --input-bg: #333333;           
            --border-color: #383838;        
            --shadow-color: rgba(0, 0, 0, 0.4); 
            --glow-color: rgba(76, 175, 80, 0.4); 
            --warning-color: #ffc107;       
            --error-color: #e74c3c;

            /* Warna baru untuk layar sukses */
            --success-bg-light: #2c3e2d; 
            --success-bg-dark: #1f2a20;  
        }

        /* Styling dasar Body dan Container */
        body {
            font-family: 'Inter', 'Helvetica Neue', Arial, sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            
            /* MODIFIKASI: Hapus align-items/justify-content agar konten form bisa di-scroll */
            display: flex;
            justify-content: center; /* Tetap pusatkan horizontal */
            
            min-height: 100vh; 
            margin: 0;
            padding: 20px;
            flex-direction: column; 
            overflow-x: hidden; /* Cegah scroll horizontal */
        }
        
        /* WRAPPER UTAMA */
        #main-wrapper {
            width: 100%;
            max-width: 500px; 
            box-shadow: 0 15px 40px var(--shadow-color);
            border-radius: 8px; 
            overflow: hidden; 
            background-color: var(--card-background); 
            position: relative; 
            z-index: 1; 
        }

        /* --- 1. Judul Utama & Subtitle --- */
        #top-info {
            padding: 30px 20px 5px 20px; 
            text-align: center;
            background-color: var(--card-background);
        }
        
        #main-title {
            color: var(--primary-color);
            font-size: 2.5em; 
            font-weight: 700;
            margin: 0;
            text-shadow: 0 0 10px rgba(76, 175, 80, 0.4);
            letter-spacing: 0.5px;
        }
        
        /* MODIFIKASI: CSS Teks Berjalan */
        #subtitle {
            font-size: 1em;
            color: var(--text-color);
            opacity: 0.8;
            margin-top: 5px;
            font-weight: 300;
            white-space: nowrap; 
            overflow: hidden; 
            width: 100%; 
            padding: 0 10px; 
            box-sizing: border-box; 
        }

        #subtitle span {
            display: inline-block;
            padding-left: 100%; 
            animation: marquee 15s linear infinite; 
        }
        
        @keyframes marquee {
            0%   { transform: translate(0, 0); } 
            100% { transform: translate(-100%, 0); } 
        }


        /* --- 2. FOTO BANNER --- */
        #banner-image {
            width: calc(100% - 40px); 
            height: 150px; 
            margin: 5px auto; 
            border-radius: 8px; 
            background-image: url('/asset/Banner\ Form.png'); 
            background-size: cover;
            background-position: center;
            filter: brightness(0.7); 
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3); 
        }

        /* --- 3 & 4. STATUS BAR --- */
        #status-bar {
            background-color: var(--card-background); 
            padding: 10px 0; 
            font-size: 0.85em;
            text-align: center; 
            border-bottom: 1px solid var(--border-color); 
        }
        
        #current-time {
            color: var(--warning-color); 
            font-weight: 500;
            letter-spacing: 0.5px;
            display: inline-block;
        }

        /* --- 5. Container Formulir (Area Input) --- */
        .container {
            width: 100%;
            padding: 40px;
            background-color: var(--card-background);
            box-sizing: border-box; 
        }

        h2 { display: none; } 

        /* Gaya Input Field */
        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px; 
            color: var(--primary-color); 
            font-weight: 600; 
            font-size: 1em; 
            letter-spacing: 0.8px; 
            text-shadow: 0 0 3px rgba(76, 175, 80, 0.3); 
            padding-bottom: 3px;
            border-bottom: 1px solid rgba(76, 175, 80, 0.3); 
            transition: all 0.3s ease;
        }

        input[type="text"],
        textarea {
            width: 100%;
            padding: 14px; 
            background-color: var(--input-bg);
            border: 1px solid var(--border-color);
            border-radius: 6px; 
            box-sizing: border-box;
            font-size: 16px;
            color: var(--text-color);
            resize: vertical;
            transition: all 0.3s ease;
        }

        input[type="text"]:focus,
        textarea:focus {
            outline: none;
            border-color: var(--primary-color); 
            box-shadow: 0 0 0 4px var(--glow-color);
            background-color: #3a3a3a;
        }

        textarea {
            min-height: 120px;
        }

        /* Gaya Warning Opsional */
        .optional-warning {
            display: block;
            font-size: 0.8em;
            color: var(--warning-color);
            margin-top: 5px;
            font-style: italic;
            opacity: 0.9;
        }

        /* Gaya Tombol Umum */
        .btn {
            width: 100%;
            padding: 16px; 
            background: var(--primary-color); 
            color: var(--card-background);
            border: none;
            border-radius: 6px; 
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        #submitButton:hover:not(.loading) {
            background-color: var(--secondary-color); 
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
        }
        
        /* --- Gaya Loading (Spinner) --- */
        .spinner {
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top: 3px solid white; 
            border-radius: 50%;
            width: 18px;
            height: 18px;
            animation: spin 0.8s cubic-bezier(0.68, -0.55, 0.27, 1.55) infinite;
            display: none; 
            margin-right: 10px; 
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* State Tombol Saat Loading */
        #submitButton.loading {
            background-color: #383838; 
            pointer-events: none; 
            cursor: default;
            transform: none;
            box-shadow: none;
        }

        #submitButton.loading .spinner {
            display: block; 
        }

        /* Gaya pesan status (Error) */
        #status {
            text-align: center;
            margin-top: 25px;
            padding: 15px;
            border-radius: 6px;
            font-weight: 500;
            display: none; 
            font-size: 0.95em;
            border: 1px solid var(--error-color);
            background-color: #381f1f;
            color: var(--error-color);
        }

        /* --- MODIFIKASI: Gaya Tampilan Sukses (Layar Sukses Beranimasi) --- */
        #successScreen {
            text-align: center;
            padding: 50px 30px; 
            opacity: 0;
            animation: fadeIn 0.8s forwards;
            background: linear-gradient(135deg, var(--success-bg-dark) 0%, var(--success-bg-light) 100%);
            position: relative;
            overflow: hidden;
            border-radius: 8px; 
        }
        /* Animasi latar belakang sukses */
        #successScreen::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle at center, rgba(76, 175, 80, 0.1) 0%, transparent 70%);
            animation: successBackgroundPulse 8s linear infinite;
            z-index: 0;
        }

        @keyframes successBackgroundPulse {
            0% { transform: scale(0.5) rotate(0deg); opacity: 0.4; }
            50% { transform: scale(1.2) rotate(180deg); opacity: 0.2; }
            100% { transform: scale(0.5) rotate(360deg); opacity: 0.4; }
        }

        #successScreen > * { 
            position: relative;
            z-index: 1;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- IKON SUKSES BARU: Efek 3D Pop & Bounce SVG --- */
        .success-icon {
            width: 100px; 
            height: 100px; 
            margin: 0 auto 20px auto;
            position: relative;
            transform: scale(0.5); 
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; 
        }

        @keyframes popIn {
            100% { transform: scale(1); }
        }

        .success-icon .checkmark {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            display: block;
            stroke-width: 5;
            stroke: var(--primary-color);
            stroke-miterlimit: 10;
            fill: rgba(76, 175, 80, 0.1); 
            transform-origin: 50% 50%;
        }

        .success-icon .checkmark__circle {
            stroke-dasharray: 166;
            stroke-dashoffset: 166;
            stroke-width: 5;
            stroke-miterlimit: 10;
            stroke: var(--primary-color); 
            fill: none;
            filter: drop-shadow(0 0 5px var(--glow-color)); 
            animation: stroke 0.6s cubic-bezier(0.65, 0, 0.45, 1) forwards;
        }

        .success-icon .checkmark__check {
            transform-origin: 50% 50%;
            stroke-dasharray: 48;
            stroke-dashoffset: 48;
            stroke-width: 5;
            stroke-linecap: round;
            stroke-linejoin: round;
            stroke: var(--primary-color); 
            filter: drop-shadow(0 0 3px var(--glow-color)); 
            animation: stroke 0.3s cubic-bezier(0.65, 0, 0.45, 1) 0.8s forwards, 
                       bounce 0.3s ease-in-out 1.1s; 
        }

        @keyframes stroke {
            100% {
                stroke-dashoffset: 0;
            }
        }

        @keyframes bounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.15); } 
        }
        /* --- AKHIR IKON SUKSES BARU --- */

        #successScreen h3 {
            color: var(--primary-color); 
            font-size: 2.8em; 
            margin: 20px 0 15px 0; 
            text-shadow: 0 0 20px var(--glow-color), 0 0 10px var(--primary-color); 
            animation: textGlowPulse 2s ease-in-out infinite alternate;
        }
        /* Animasi Glow pada teks "Data Terkirim!" */
        @keyframes textGlowPulse {
            0% { text-shadow: 0 0 10px var(--glow-color), 0 0 5px var(--primary-color); }
            100% { text-shadow: 0 0 25px var(--glow-color), 0 0 15px var(--primary-color); }
        }

        #successScreen p {
            font-size: 1.1em;
            color: var(--text-color);
            margin-bottom: 40px; 
            line-height: 1.6;
            opacity: 0.9;
        }

        /* Tombol Kirim Baru menjadi Hijau Cerah */
        #sendAgainButton {
            background-color: var(--primary-color);
            color: var(--card-background);
            margin-top: 30px; 
            font-size: 1.2em; 
            padding: 18px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.5), 0 0 15px var(--glow-color); 
        }

        #sendAgainButton:hover {
            background-color: var(--secondary-color);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.6), 0 0 20px var(--glow-color); 
        }

        /* Kelas untuk menyembunyikan header/status saat sukses */
        .hide-header #top-info,
        .hide-header #banner-image,
        .hide-header #status-bar {
            display: none !important; 
        }

        /* MODIFIKASI: Penyesuaian Layout saat Sukses agar bisa di-scroll jika diperlukan */
        .hide-header #main-wrapper {
            height: 100vh; /* Set tinggi wrapper menjadi 100% viewport */
            display: flex; 
            flex-direction: column; 
            justify-content: center; /* Pusatkan di tengah */
            align-items: center; 
            width: 100%;
            max-width: 100%; 
            box-shadow: none; 
            background-color: transparent; 
            border-radius: 0; 
            overflow-y: auto; /* IZINKAN SCROLL JIKA KONTEN LEBIH DARI 100VH */
        }
        
        body.hide-header {
             align-items: center;
             justify-content: center;
             display: flex;
        }
        
        .hide-header #main-wrapper .container {
             background-color: transparent; 
             padding: 0;
             display: flex; 
             justify-content: center;
             align-items: center;
             width: 100%;
        }
        .hide-header #successScreen {
            background: linear-gradient(135deg, var(--success-bg-dark) 0%, var(--success-bg-light) 100%);
            width: calc(100% - 40px); 
            max-width: 500px;
            border-radius: 8px; 
            box-shadow: 0 15px 40px var(--shadow-color); 
        }
    </style>
</head>
<body>
    
    <div id="main-wrapper"> 
        
        <div id="top-info">
            <h1 id="main-title">FORM MESSAGE</h1>
            <p id="subtitle">
                <span>Kamu bisa menyampaikan secara langsung atau memberi pesan kepada saya. Anda bisa menampilkan nama atau mengosongkan nama. Semua Privacy anda tidak akan terbaca apapun, data yang terbaca adalah hasil form dan telah berhasil terkirim.</span>
            </p>
        </div>

        <div id="banner-image"></div>
        
        <div id="status-bar">
            <div id="current-time"></div>
        </div>
        
        <div class="container">
            
            <div id="formSection">
                <form id="contactForm" action="https://script.google.com/macros/s/AKfycbxtne-ADt0AKyDer7PXDHljU2Jl9MEp7mkhjUlSyREzl4jjcRgPYccON4WtC83zwb3k4Q/exec" method="POST"> 
                    
                    <div class="form-group">
                        <label for="nama">Nama Pengirim</label>
                        <input type="text" id="nama" name="nama" placeholder="isi nama anda atau inisial, atau kosongi saja...">
                        <span class="optional-warning">⚠️ Kosongkan untuk kiriman anonim.</span>
                    </div>
                    
                    <div class="form-group">
                        <label for="pesan">Isi Pesan atau Catatan</label>
                        <textarea id="pesan" name="pesan" required placeholder="Pesan wajib diisi. Tulis pesan Anda di sini..."></textarea>
                    </div>

                    <button type="submit" id="submitButton" class="btn">
                        <div class="spinner"></div> 
                        <span id="buttonText">SUBMIT</span>
                    </button>
                </form>
                <div id="status"></div>
            </div>
            
            <div id="successScreen" style="display:none;">
                <div class="success-icon">
                    <svg class="checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52">
                        <circle class="checkmark__circle" cx="26" cy="26" r="25" fill="none"/>
                        <path class="checkmark__check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/>
                    </svg>
                </div>
                <h3>Data Terkirim!</h3>
                <p>Terima kasih atas pesan dan catatan anda. Data berhasil dicatat dengan waktu sistem.</p>
                <button id="sendAgainButton" class="btn">KIRIM BARU</button>
            </div>
        </div>
    </div>

<script>
    const webAppURL = "https://script.google.com/macros/s/AKfycbxtne-ADt0AKyDer7PXDHljU2Jl9MEp7mkhjUlSyREzl4jjcRgPYccON4WtC83zwb3k4Q/exec"; 
    
    const body = document.body; 
    const form = document.getElementById('contactForm');
    const statusDiv = document.getElementById('status');
    const submitButton = document.getElementById('submitButton');
    const buttonText = document.getElementById('buttonText');
    const currentTimeDiv = document.getElementById('current-time');
    
    const formSection = document.getElementById('formSection');
    const successScreen = document.getElementById('successScreen');
    const sendAgainButton = document.getElementById('sendAgainButton');

    // --- FUNGSI JAM OTOMATIS ---
    function updateTime() {
        const now = new Date();
        const dayOptions = { weekday: 'long' };
        const dateOptions = { day: '2-digit', month: 'long', year: 'numeric' }; 
        const timeOptions = { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false };
        
        const dayString = now.toLocaleDateString('id-ID', dayOptions);
        const dateString = now.toLocaleDateString('id-ID', dateOptions);
        const timeString = now.toLocaleTimeString('id-ID', timeOptions);
        
        currentTimeDiv.textContent = `${dayString}, ${dateString} | ${timeString}`;
    }
    setInterval(updateTime, 1000);
    updateTime();

    function showSuccess() {
        formSection.style.display = 'none';
        successScreen.style.display = 'block';
        body.classList.add('hide-header'); 
    }

    function showForm() {
        form.reset();
        successScreen.style.display = 'none';
        formSection.style.display = 'block';
        statusDiv.style.display = 'none';
        body.classList.remove('hide-header'); 
    }

    sendAgainButton.addEventListener('click', showForm);

    form.addEventListener('submit', function(e) {
        e.preventDefault(); 
        
        if (!document.getElementById('pesan').value.trim()) {
            showStatus('Pesan wajib diisi!', 'status-error');
            return;
        }

        submitButton.classList.add('loading');
        buttonText.textContent = 'MENGIRIM...'; 
        statusDiv.style.display = 'none';

        const formData = new FormData(form);
        const data = {};
        formData.forEach((value, key) => data[key] = value);
        
        if (data.nama === "") {
            data.nama = "Anonim"; 
        }

        fetch(webAppURL, {
            method: 'POST',
            mode: 'cors', 
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: new URLSearchParams(data).toString(), 
        })
        .then(response => {
             if (!response.ok) {
                throw new Error('Jaringan bermasalah atau Apps Script Error');
             }
             return response.json(); 
        })
        .then(result => {
            if (result.result === 'success') {
                showSuccess(); 
            } else {
                showStatus(`Terjadi kesalahan: ${result.message || 'Gagal menyimpan data.'}`, 'status-error');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            showStatus('Gagal terhubung ke server. Cek koneksi Anda.', 'status-error');
        })
        .finally(() => {
            submitButton.classList.remove('loading');
            buttonText.textContent = 'SUBMIT';
        });
    });
    
    function showStatus(message, className) {
        statusDiv.textContent = message;
        statusDiv.className = ''; 
        statusDiv.classList.add(className);
        statusDiv.style.display = 'block';
    }
</script>

</body>
</html>
